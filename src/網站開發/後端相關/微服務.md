# 微服務學習筆記

## AKF 拆分原則

![](https://i.imgur.com/zOeWIYv.png)

參考自此書 [The Art of Scalability: Scalable Web Architecture，Processes，and Organizations for the Modern Enterprise](https://akfpartners.com/books/the-art-of-scalability) 是一群技術專家總結出來對於單體應用拓展的三個維度(X-Y-Z軸).依照這擴展模式，可以將一個單體架構(大方塊就是一個單體系統)無限擴展.

* **X軸 - 水平擴容/複製**
    * 直接複製單體服務，再透過負載均衡服務針對 N 個實例進行請求分配，這樣每個實例只需要處理1/N 的負載即可，進而提高吞吐量與可用性。
    * 優點
        * 因為只是單純的複製，所以理論上比較容易，而且能快速實現
    * 缺點
        * 每個服務都能訪問到完整的數據，所以變成資料庫之間的數據要進行複製，成本很高，而且存放的資料很多，快取命中也不高。對於組織而言，每個人的職責難以切分，大家還是得面對同一個單體。
       
* **Z軸 - 數據分區**
    * Z軸擴展也是複製單體程序到多個實例上，但跟X軸不同的是，每個實例僅負責一部分的資料子集合.換句話說，就是根據某些規則絕對該請求到那一個實例程序上。
        * 像是根據用戶 ID 是奇數或偶數區分不同服務、電商根據品項區分不同服務、或是根據用戶請求地區等等。
    * 優點
        * 提供故障隔離性; 若有一區故障只有一部分資料與對應的客戶受影響，相對前者而言，因為資料數量變少了，自然快取命中就會上升，處理回應時間也會減少。
    * 缺點
        * 實現有的成本較高，資料不一定容易分區，程式的複雜性也較高，因為要處理分區問題
* **Y軸 - 功能/業務的分解**
    * Y 軸就是進行功能的切分，根據不同的業務來劃分。有的會依照「動詞 Verb」劃分，像是結帳、驗證、購買、註冊；也有是按照「名詞 Noun」來做分解，舉例:客戶、訂單、報表、商品列表等等，也有的是根據 DDD 的Subdomain 來拆分.
    * 優點
        * 程式的複雜度降低了、而且也有故障隔離性，由於每組服務只負責對應業務的資料快取，所以命中率也是很高，對組織而言，也可以按照業務來劃分。
    * 缺點
        * 服務管理難度較高

參考來源： https://ithelp.ithome.com.tw/articles/10235057
